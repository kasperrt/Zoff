!function(){function e(e){"parent"==e.data&&(window.parentWindow=e.source,window.parentOrigin=e.origin),"lower"==e.data?window.setVolume(10):"reset"==e.data?window.setVolume(100):"get_info"==e.data&&(window.parentWindow.postMessage({type:"np",title:m},window.parentOrigin),window.parentWindow.postMessage({type:"controller",id:D.old_id},window.parentOrigin),full_playlist.length>0&&s.sendNext({title:full_playlist[0].title,videoId:full_playlist[0].id}))}function t(e){c.on(e,D.host_on_action)}function a(){c.on("id",D.host_listener)}function i(){c.on("np",s.youtube_listener)}function n(){c.on("channel",f.channel_function)}function l(e){$("#volume").slider("value",e),h.setVolume(e)}var s={loaded:!0,before_load:"",after_load:"",player:"",stopInterval:!1,fireplace:"",youtube_listener:function(e){var t;k&&e.np&&window.parentWindow&&window.parentOrigin&&(window.parentWindow.postMessage({type:"np",title:e.np[0].title},window.parentOrigin),full_playlist.length>0&&s.sendNext({title:full_playlist[0].title,videoId:full_playlist[0].id}));try{t=s.player.getPlayerState()}catch(e){t=null}if((!V&&(null!=t||L)||V&&(null==t||L)||!V&&(null==t||L)||V&&-1==t)&&(!V||prev_chan_player!=z)||V&&void 0==d){prev_chan_player=z,L=!1,s.loaded=!1,o.log("--------youtube_listener--------"),o.log("Received: "),o.log(e),o.log("paused variable: "+y),o.log("mobile_beginning variable: "+T);try{o.log("getVideoUrl(): "+s.player.getVideoUrl().split("v=")[1])}catch(e){}if(o.log("video_id variable: "+d),o.log("---------------------------------"),e.np){if(y)s.getTitle(e.np[0].title,viewers),o.mobilecheck()||s.notifyUser(e.np[0].id,e.np[0].title),M||s.stopVideo(),d=e.np[0].id,conf=e.conf[0],time=e.time,p=time-conf.startTime,m=e.np[0].title,duration=e.np[0].duration,s.setBGimage(d);else if(!y){void 0===u?u=e.np[0].id:u!=d&&(u=d),d=e.np[0].id,conf=e.conf[0],time=e.time,p=time-conf.startTime,m=e.np[0].title,duration=e.np[0].duration,T&&o.mobilecheck()&&0===p&&!M&&(p=1);try{full_playlist[0].id!=d||T||f.song_change(full_playlist[0].added),Suggestions.fetchYoutubeSuggests(d)}catch(e){}if(s.getTitle(m,viewers),s.setBGimage(d),_&&!window.MSStream)try{var a;try{a=s.player.getVideoUrl().split("v=")[1]!=d}catch(e){a=!0}(a||M)&&(s.loadVideoById(d,duration),o.mobilecheck()||s.notifyUser(d,m),s.seekTo(p),y&&!M&&s.pauseVideo()),y||(T&&!M||s.playVideo(),I||s.durationSetter()),(s.player.getDuration()>p||0===s.player.getDuration()||M||s.player.getCurrentTime()!=p)&&s.seekTo(p),s.after_load=d,s.loaded||setTimeout(function(){s.loaded=!0},500)}catch(e){M&&(s.loadVideoById(d,duration),s.seekTo(p)),I||M||s.durationSetter()}else s.getTitle(m,viewers)}}else{document.getElementById("song-title").innerHTML="Empty channel. Add some songs!",document.title="Zoff - the shared YouTube based radio",$("#channel-load").css("display","none"),window.MSStream||M||$("#player_overlay").hasClass("hide")&&$("#player_overlay").removeClass("hide");try{M||s.stopVideo()}catch(e){}}}else I||s.durationSetter(),duration=s.player.getDuration()},onPlayerStateChange:function(e){o.log("-------onPlayerStateChange------"),o.log("New state\nState: "),o.log(e);try{o.log("Duration: "+s.player.getDuration(),"Current time: "+s.player.getCurrentTime()),o.log("getVideoUrl(): "+s.player.getVideoUrl().split("v=")[1])}catch(e){}switch(o.log("video_id variable: "+d),o.log("---------------------------------"),e.data){case YT.PlayerState.UNSTARTED:break;case YT.PlayerState.ENDED:playing=!1,y=!1,V?s.playNext():c.emit("end",{id:d,channel:z.toLowerCase(),pass:k?"":q.crypt_pass(q.get_userpass(z.toLowerCase()))});break;case YT.PlayerState.PLAYING:window.MSStream||($("#player").css("opacity","1"),o.mobilecheck()||$("#channel-load").css("display","none")),playing=!0,beginning&&o.mobilecheck()&&!M&&(beginning=!1,T=!1),k||"/"==window.location.pathname||M||o.addClass("#player_overlay","hide"),"/"!=window.location.pathname&&(1==document.getElementById("play").className.split(" ").length&&$("#play").toggleClass("hide"),2==document.getElementById("pause").className.split(" ").length&&$("#pause").toggleClass("hide")),y&&!V&&(c.emit("pos",{channel:z.toLowerCase(),pass:k?"":q.crypt_pass(q.get_userpass(z.toLowerCase()))}),y=!1);break;case YT.PlayerState.PAUSED:M||(beginning&&T&&($("#playpause").css("visibility","visible"),$("#playpause").css("pointer-events","all"),$("#channel-load").css("display","none")),y=!0,"/"!=window.location.pathname&&h.play_pause_show(),T=!0);break;case YT.PlayerState.BUFFERING:}},playVideo:function(){M?(castSession.sendMessage("urn:x-cast:zoff.me",{type:"playVideo"}),chrome.cast.media.GenericMediaMetadata({metadataType:"GENERIC",title:m,image:"https://img.youtube.com/vi/"+d+"/mqdefault.jpg"}),chrome.cast.Image("https://img.youtube.com/vi/"+d+"/mqdefault.jpg"),$("#pause").hasClass("hide")&&($("#play").toggleClass("hide"),$("#pause").toggleClass("hide"))):s.player.playVideo()},pauseVideo:function(){M?(castSession.sendMessage("urn:x-cast:zoff.me",{type:"pauseVideo"}),$("#play").hasClass("hide")&&($("#play").toggleClass("hide"),$("#pause").toggleClass("hide"))):s.player.pauseVideo()},seekTo:function(e){M?castSession.sendMessage("urn:x-cast:zoff.me",{type:"seekTo",seekTo:e}):V?s.player.seekTo(0):s.player.seekTo(e)},loadVideoById:function(e,t){M?(castSession.sendMessage("urn:x-cast:zoff.me",{type:"loadVideo",videoId:e,channel:z.toLowerCase()}),chrome.cast.media.GenericMediaMetadata({metadataType:"GENERIC",title:m,image:"https://img.youtube.com/vi/"+e+"/mqdefault.jpg"}),chrome.cast.Image("https://img.youtube.com/vi/"+e+"/mqdefault.jpg")):s.player.loadVideoById({videoId:e,startSeconds:0,endSeconds:t})},stopVideo:function(){if(M)castSession.sendMessage("urn:x-cast:zoff.me",{type:"stopVideo"});else try{s.player.stopVideo()}catch(e){}},setVolume:function(e){M?castSession.setVolume(e/100):s.player.setVolume(e)},playNext:function(){var e=full_playlist[0];d=e.id,time=(new Date).getTime(),m=e.title,duration=e.duration,s.getTitle(m,viewers),s.setBGimage(d),M?(castSession.sendMessage("urn:x-cast:zoff.me",{type:"loadVideo",videoId:d,channel:z.toLowerCase()}),chrome.cast.media.GenericMediaMetadata({metadataType:"GENERIC",title:m,image:"https://img.youtube.com/vi/"+d+"/mqdefault.jpg"}),chrome.cast.Image("https://img.youtube.com/vi/"+d+"/mqdefault.jpg")):s.loadVideoById(d,duration),f.channel_function({type:"song_change",time:time})},playPrev:function(){var e=full_playlist.length-2;e<0&&(e=0);var t=full_playlist[e];d=t.id,time=(new Date).getTime(),m=t.title,duration=t.duration,s.getTitle(m,viewers),s.setBGimage(d),M?(castSession.sendMessage("urn:x-cast:zoff.me",{type:"loadVideo",videoId:d,channel:z.toLowerCase()}),chrome.cast.media.GenericMediaMetadata({metadataType:"GENERIC",title:m,image:"https://img.youtube.com/vi/"+d+"/mqdefault.jpg"}),chrome.cast.Image("https://img.youtube.com/vi/"+d+"/mqdefault.jpg")):s.loadVideoById(d,duration),f.channel_function({type:"song_change_prev",time:time})},sendNext:function(e){M&&castSession.sendMessage("urn:x-cast:zoff.me",{type:"nextVideo",title:e.title,videoId:e.videoId}),k&&window.parentWindow&&window.parentOrigin&&window.parentWindow.postMessage({type:"nextVideo",title:e.title},window.parentOrigin)},getTitle:function(e,t){var a=decodeURIComponent(e);if("/"!=window.location.pathname){var i=document.getElementById("song-title"),n=document.getElementById("viewers");i.innerHTML=a,n.innerHTML="<i class='material-icons'>visibility</i> "+t,i.title=a,M&&($("#player_overlay").css("background","url(https://img.youtube.com/vi/"+d+"/hqdefault.jpg)"),$("#player_overlay").css("background-position","center"),$("#player_overlay").css("background-size","100%"),$("#player_overlay").css("background-color","black"),$("#player_overlay").css("background-repeat","no-repeat"))}document.title=a+" â€¢ Zoff / "+z},errorHandler:function(e){j||(5==e.data||100==e.data||101==e.data||150==e.data?(curr_playing=s.player.getVideoUrl().replace("https://www.youtube.com/watch?v=",""),c.emit("skip",{error:e.data,id:d,pass:""==S?"":q.crypt_pass(S),channel:z.toLowerCase(),userpass:k?"":q.crypt_pass(q.get_userpass(z.toLowerCase()))})):void 0!==d&&s.loadVideoById(d,duration))},onPlayerReady:function(e){try{beginning=!0,_=!0,window.MSStream||(o.mobilecheck()&&($("#playpause").css("visibility","hidden"),$("#playpause").css("pointer-events","none"),$("#player").css("opacity","1")),$(".video-container").removeClass("no-opacity"),$("#controls").css("opacity","1"),$(".playlist").css("opacity","1"),s.loadVideoById(d,duration),!Y||o.mobilecheck()&&!M||s.playVideo(),I||s.durationSetter(),k?setTimeout(function(){s.player.seekTo(p),Y||(s.player.pauseVideo(),h.play_pause_show())},1e3):s.seekTo(p)),s.readyLooks(),h.initYoutubeControls(s.player),h.initSlider(),s.player.setVolume(q.get_volume())}catch(e){}},readyLooks:function(){s.setBGimage(d)},setBGimage:function(e){if(void 0!==e&&!k){var t=new Image;t.onload=function(){var e=new ColorThief,a=e.getColor(t);"/"!=window.location.pathname&&(document.getElementById("main-container").style.backgroundColor=o.rgbToHsl(a,!0),$("meta[name=theme-color]").attr("content",o.rgbToHex(a[0],a[1],a[2])))},t.crossOrigin="Anonymous",t.src="https://zoff.me:8081/https://img.youtube.com/vi/"+e+"/mqdefault.jpg"}},set_width:function(e){if($(".video-container").width(e),!o.mobilecheck())if($(window).width()>769){var t=$(window).width()-$(".control-list").width()-$(".zbrand").outerWidth()-$(".brand-logo-navigate").outerWidth()-66;title_width=t,$(".title-container").width(title_width)}else $(".title-container").width("100%")},notifyUser:function(e,t){if(t=t.replace(/\\\'/g,"'").replace(/&quot;/g,"'").replace(/&amp;/g,"&"),"granted"===Notification.permission&&document.hidden&&!k){var a=new Notification("Now Playing",{body:t,icon:"https://i.ytimg.com/vi/"+e+"/mqdefault.jpg",iconUrl:"http://i.ytimg.com/vi/"+e+"/mqdefault.jpg"});a.onclick=function(e){window.focus(),this.cancel()},setTimeout(function(){a.close()},5e3)}},setup_all_listeners:function(){get_list_listener(),i(),setup_admin_listener(),setup_chat_listener(),n()},onYouTubeIframeAPIReady:function(){s.player=new YT.Player("player",{videoId:d,playerVars:{rel:"0",wmode:"transparent",controls:"0",fs:"0",iv_load_policy:"3",theme:"light",color:"white",showinfo:0},events:{onReady:s.onPlayerReady,onStateChange:s.onPlayerStateChange,onError:s.errorHandler}})},createFireplacePlayer:function(){s.fireplace=new YT.Player("fireplace_player",{videoId:"L_LUpnjgPso",playerVars:{rel:"0",wmode:"transparent",controls:"0",fs:"0",iv_load_policy:"3",theme:"light",color:"white",showinfo:0},events:{onReady:s.onFireplaceReady,onStateChange:s.onFireplaceChange}})},onFireplaceReady:function(){s.fireplace.playVideo()},onFireplaceChange:function(e){switch(e.data){case 0:s.fireplace.seekTo(0),s.fireplace.playVideo();break;case 2:s.fireplace.playVideo()}},durationSetter:function(){try{O||void 0===duration||(s.stopInterval||(I=!0),dMinutes=Math.floor(duration/60),dSeconds=duration-60*dMinutes,currDurr=void 0!==s.player.getCurrentTime()?Math.floor(s.player.getCurrentTime()):p,currDurr>duration&&(currDurr=duration),minutes=Math.floor(currDurr/60),seconds=currDurr-60*minutes,document.getElementById("duration").innerHTML=o.pad(minutes)+":"+o.pad(seconds)+" <span id='dash'>/</span> "+o.pad(dMinutes)+":"+o.pad(dSeconds),per=100/duration*currDurr,per>=100?per=100:0===duration&&(per=0),k&&window.parentWindow&&window.parentOrigin&&window.parentWindow.postMessage({type:"duration",duration:s.player.getCurrentTime(),full_duration:s.player.getDuration(),percent:per},window.parentOrigin),B||$("#bar").width(per+"%"))}catch(e){}s.stopInterval||setTimeout(s.durationSetter,1e3)},loadPlayer:function(){if(1==$("script[src='https://www.youtube.com/iframe_api']").length)try{s.onYouTubeIframeAPIReady()}catch(e){console.error("Seems YouTube iFrame script isn't correctly loaded. Please reload the page.")}else tag=document.createElement("script"),tag.src="https://www.youtube.com/iframe_api",firstScriptTag=document.getElementsByTagName("script")[0],firstScriptTag.parentNode.insertBefore(tag,firstScriptTag)}},o={log:function(e){"true"===localStorage.debug&&console.log(e)},rnd:function(e){return e[Math.floor(Math.random()*e.length)]},mobilecheck:function(){var e=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(e=!0),e},predicate:function(){for(var e,t,a,i=[],n=arguments.length,l=function(e,t){return void 0==e&&(e=0),void 0==t&&(t=0),e===t?0:e<t?-1:1},s=function(e,t){var a=l,i=l;return e&&(i=function(t,i){return a(e(t),e(i))}),t?function(e,t){return-1*i(e,t)}:i},o=0;o<n;o++)e=arguments[o],"string"==typeof e?(t=e,a=l):(t=e.name,a=s(e.primer,e.reverse)),i.push({name:t,cmp:a});return function(t,a){for(var l,s,o=0;o<n&&(s=0,e=i[o],l=e.name,0===(s=e.cmp(t[l],a[l])));o++);return s}},hashCode:function(e){for(var t=0,a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<5)-t);return t},intToARGB:function(e){return(e>>24&255).toString(16)+(e>>16&255).toString(16)+(e>>8&255).toString(16)+(255&e).toString(16)},hexToRgb:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},hslToRgb:function(e,t,a){function i(e,t,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e}var n,l,s;if(0==t)n=l=s=a;else{var o=a<.5?a*(1+t):a+t-a*t,r=2*a-o;n=i(r,o,e+1/3),l=i(r,o,e),s=i(r,o,e-1/3)}return[255*n,255*l,255*s]},pad:function(e){return e<10?"0"+Math.floor(e):Math.floor(e)},contains:function(e,t){for(var a=e.length;a--;)if(e[a]===t)return!0;return!1},sample:function(){Date.now()-lastSample>=2*SAMPLE_RATE&&(c.removeAllListeners(),c.disconnect(),c.connect(),s.setup_all_listeners()),lastSample=Date.now(),setTimeout(o.sample,SAMPLE_RATE)},msieversion:function(){return!!(window.navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.match(/Trident.*rv\:11\./))},getRandomInt:function(e,t){return Math.floor(Math.random()*(t-e))+e},secondsToOther:function(e){var t=e,a=Math.floor(t/60);return t-=60*a,[a,t]},rgbToHsl:function(e,t){r=e[0],g=e[1],b=e[2],r/=255,g/=255,b/=255;var a,i,n=Math.max(r,g,b),l=Math.min(r,g,b),s=(n+l)/2;if(n==l)a=i=0;else{var o=n-l;switch(i=s>.5?o/(2-n-l):o/(n+l),n){case r:a=(g-b)/o+(g<b?6:0);break;case g:a=(b-r)/o+2;break;case b:a=(r-g)/o+4}a/=6}return s>.5&&t?s=.4:s<.65&&!t&&(s=.65),"hsl("+Math.floor(360*a)+", "+Math.floor(100*i)+"%, "+Math.floor(100*s)+"%)"},componentToHex:function(e){var t=e.toString(16);return 1==t.length?"0"+t:t},rgbToHex:function(e,t,a){return"#"+o.componentToHex(e)+o.componentToHex(t)+o.componentToHex(a)},upperFirst:function(e){return e.substring(0,1).toUpperCase()+e.substring(1).toLowerCase()},addClass:function(e,t){o.contains($(e).attr("class").split(" "),t)||$(e).addClass(t)},send_mail:function(e,t){""!==e&&""!==t&&($("#submit-contact-form").addClass("hide"),$("#send-loader").removeClass("hide"),$("#contact-form-from").attr("disabled","true"),$("#contact-form-message").attr("disabled","true"),$.ajax({type:"POST",data:{from:e,message:t},url:"/api/mail",success:function(e){"success"==e?($("#contact-container").empty(),$("#contact-container").html("Mail has been sent, we'll be back with you shortly.")):($("#contact-container").empty(),$("#contact-container").html("Something went wrong, sorry about that. You could instead try with your own mail-client: <a title='Open in client' href='mailto:contact@zoff.no?Subject=Contact%20Zoff'>contact@zoff.no</a>"))}}))},firstY:null,lastY:null,currentY:null,vertScroll:!1,initAdjustment:0,touchstart:function(e){o.lastY=o.currentY=o.firstY=e.originalEvent.touches[0].pageY},touchmove:function(e){o.currentY=e.originalEvent.touches[0].pageY;var t=o.lastY-o.currentY;!o.vertScroll&&Math.abs(o.currentY-o.firstY)>30&&(o.vertScroll=!0,o.initAdjustment=o.currentY-o.firstY),o.vertScroll&&(window.scrollBy(0,t+o.initAdjustment),o.lastY=o.currentY+t)},touchend:function(e){o.vertScroll=!1,o.firstY=null,o.currentY=null,o.vertScroll=!1,o.initAdjustment=0,o.currentY=null},invertColor:function(e){if(0===e.indexOf("#")&&(e=e.slice(1)),3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),6!==e.length)throw new Error("Invalid HEX color.");var t=(255-parseInt(e.slice(0,2),16)).toString(16),a=(255-parseInt(e.slice(2,4),16)).toString(16),i=(255-parseInt(e.slice(4,6),16)).toString(16);return"#"+padZero(t)+padZero(a)+padZero(i)},padZero:function(e,t){return t=t||2,(new Array(t).join("0")+e).slice(-t)}};Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var e=0,t=this.length;e<t;e++)this[e]&&this[e].parentElement&&this[e].parentElement.removeChild(this[e])},String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t};var p,c,d,u,h={stopInterval:!1,initYoutubeControls:function(){o.mobilecheck()&&!window.MSStream&&$("#controls").appendTo("#playbar"),h.initControls()},initControls:function(){$("#volume-button").on("click",h.mute_video),$("#playpause").on("click",h.play_pause),$("#volume-button-overlay").on("click",h.mute_video),$("#playpause-overlay").on("click",h.play_pause),$("#fullscreen").on("click",h.fullscreen)},initSlider:function(){try{C=q.get_volume()}catch(e){}var e={min:0,max:100,value:C,range:"min",animate:!0,slide:function(e,t){h.setVolume(t.value);try{q.set_volume(t.value)}catch(e){}}};o.mobilecheck()&&(e.orientation="vertical",$(".volume-container").toggleClass("hide")),$("#volume").slider(e),h.choose_button(C,!1)},fullscreen:function(){var e=$("#player"),t=e.requestFullScreen||e.mozRequestFullScreen||e.webkitRequestFullScreen;t&&t.bind(e)()},play_pause:function(){M?h.play_pause_show():s.player.getPlayerState()==YT.PlayerState.PLAYING?(s.pauseVideo(),o.mobilecheck()&&!window.MSStream&&($("#player").css("display","none"),$(".video-container").toggleClass("click-through"),$(".page-footer").toggleClass("padding-bottom-extra"))):s.player.getPlayerState()!=YT.PlayerState.PAUSED&&s.player.getPlayerState()!==YT.PlayerState.ENDED&&s.player.getPlayerState()!==YT.PlayerState.CUED||(s.playVideo(),o.mobilecheck()&&!window.MSStream&&($("#player").css("display","block"),$(".video-container").toggleClass("click-through"),$(".page-footer").toggleClass("padding-bottom-extra")))},play_pause_show:function(){M?$("#play").hasClass("hide")?s.pauseVideo():$("#pause").hasClass("hide")&&s.playVideo():($("#pause").hasClass("hide")||($("#pause").toggleClass("hide"),$("#pause-overlay").toggleClass("hide")),$("#play").hasClass("hide")&&($("#play").toggleClass("hide"),$("#play-overlay").toggleClass("hide")))},settings:function(){$("#qS").toggleClass("hide")},changeQuality:function(e){s.player.getPlaybackQuality!=e&&(s.player.setPlaybackQuality(e),s.player.getPlaybackQuality()),$("#qS").toggleClass("hide")},mute_video:function(){o.mobilecheck()?$(".volume-container").toggleClass("hide"):s.player.isMuted()?(M&&castSession.sendMessage("urn:x-cast:zoff.me",{type:"unMute"}),s.player.unMute(),h.choose_button(s.player.getVolume(),!1)):(M&&castSession.sendMessage("urn:x-cast:zoff.me",{type:"mute"}),h.choose_button(0,!0),s.player.mute())},setVolume:function(e){s.setVolume(e),h.choose_button(e,!1),s.player.isMuted()&&s.player.unMute()},choose_button:function(e,t){t?($("#v-full").hasClass("hide")||($("#v-full").toggleClass("hide"),$("#v-full-overlay").toggleClass("hide")),$("#v-medium").hasClass("hide")||($("#v-medium").toggleClass("hide"),$("#v-medium-overlay").toggleClass("hide")),$("#v-low").hasClass("hide")||($("#v-low").toggleClass("hide"),$("#v-low-overlay").toggleClass("hide")),$("#v-mute").hasClass("hide")&&($("#v-mute").toggleClass("hide"),$("#v-mute-overlay").toggleClass("hide"))):e>=0&&e<=33?($("#v-full").hasClass("hide")||($("#v-full").toggleClass("hide"),$("#v-full-overlay").toggleClass("hide")),$("#v-medium").hasClass("hide")||($("#v-medium").toggleClass("hide"),$("#v-medium-overlay").toggleClass("hide")),$("#v-low").hasClass("hide")&&($("#v-low").toggleClass("hide"),$("#v-low-overlay").toggleClass("hide")),$("#v-mute").hasClass("hide")||($("#v-mute").toggleClass("hide"),$("#v-mute-overlay").toggleClass("hide"))):e>=34&&e<=66?($("#v-full").hasClass("hide")||($("#v-full").toggleClass("hide"),$("#v-full-overlay").toggleClass("hide")),$("#v-medium").hasClass("hide")&&($("#v-medium").toggleClass("hide"),$("#v-medium-overlay").toggleClass("hide")),$("#v-low").hasClass("hide")||($("#v-low").toggleClass("hide"),$("#v-low-overlay").toggleClass("hide")),$("#v-mute").hasClass("hide")||($("#v-mute").toggleClass("hide"),$("#v-mute-overlay").toggleClass("hide"))):e>=67&&e<=100&&($("#v-full").hasClass("hide")&&($("#v-full").toggleClass("hide"),$("#v-full-overlay").toggleClass("hide")),$("#v-medium").hasClass("hide")||($("#v-medium").toggleClass("hide"),$("#v-medium-overlay").toggleClass("hide")),$("#v-low").hasClass("hide")||($("#v-low").toggleClass("hide"),$("#v-low-overlay").toggleClass("hide")),$("#v-mute").hasClass("hide")||($("#v-mute").toggleClass("hide"),$("#v-mute-overlay").toggleClass("hide")))},playPause:function(){state=s.player.getPlayerState(),button=document.getElementById("playpause"),state==YT.PlayerState.PLAYING?s.pauseVideo():state==YT.PlayerState.PAUSED&&s.playVideo()},volumeOptions:function(){M||(s.player.isMuted()?(s.player.unMute(),C=s.player.getVolume(),$("#volume").slider("value",s.player.getVolume())):(s.player.mute(),$("#volume").slider("value",0)))},hoverMute:function(e){C=s.player.getVolume()}},f={empty:!1,page:0,can_fit:Math.round($("#wrapper").height()/71),element_height:$("#wrapper").height()/Math.round($("#wrapper").height()/71)-25,uris:[],not_found:[],num_songs:0,dragging:function(e){if(e){if(o.mobilecheck()){var t=$(".list-song");try{$(".list-song").draggable("destroy")}catch(e){}t.off("touchstart",o.touchstart),t.off("touchmove",o.touchmove),t.off("touchend",o.touchend),$(".list-song").draggable({axis:"x",containment:[-60,0,10,0],scroll:!0,drag:function(e,t){if(o.vertScroll)return!1;t.offset.left<=-10?t.position.left=t.offset.left:t.position.left=0},stop:function(e,t){if(-50!=t.offset.left||o.vertScroll){var a=this;$(this).addClass("side_away"),$(this).css("left","0px"),setTimeout(function(){$(a).removeClass("side_away")},300)}else{try{navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&navigator.vibrate(100)}catch(e){}$(".accept-delete").attr("data-video-id",$(this).attr("data-video-id")),$("#delete_song_title").html($(this).find(".list-title").html()),$("#delete_song_alert").modal("open");var a=this;$(this).addClass("side_away"),$(this).css("left","0px"),setTimeout(function(){$(a).removeClass("side_away")},300)}}}),t.on("touchstart",o.touchstart),t.on("touchmove",o.touchmove),t.on("touchend",o.touchend)}}else{var t=$(".list-song");try{$(".list-song").draggable("destroy")}catch(e){}t.off("touchstart",o.touchstart),t.off("touchmove",o.touchmove),t.off("touchend",o.touchend)}},channel_function:function(e){switch(j&&(j=!1,$("#user_password").modal("close")),e.type){case"list":V&&(!V||e.shuffled)||V&&prev_chan_list==z?V&&prev_chan_list==z&&void 0!=full_playlist&&!e.shuffled&&(f.populate_list(full_playlist,!0),full_playlist.length>0&&s.sendNext({title:full_playlist[0].title,videoId:full_playlist[0].id})):(prev_chan_list=z,f.populate_list(e.playlist),full_playlist.length>0&&s.sendNext({title:full_playlist[0].title,videoId:full_playlist[0].id}));break;case"added":f.added_song(e.value),full_playlist.length>0&&s.sendNext({title:full_playlist[0].title,videoId:full_playlist[0].id}),found_array=[],found_array_index=0;break;case"deleted":f.deleted_song(e.value,e.removed),found_array=[],found_array_index=0;break;case"vote":V||(f.voted_song(e.value,e.time),full_playlist.length>0&&s.sendNext({title:full_playlist[0].title,videoId:full_playlist[0].id})),found_array=[],found_array_index=0;break;case"song_change":"/"!=window.location.pathname&&f.song_change(e.time,e.remove),full_playlist.length>0&&s.sendNext({title:full_playlist[0].title,videoId:full_playlist[0].id}),found_array=[],found_array_index=0;break;case"song_change_prev":"/"!=window.location.pathname&&f.song_change_prev(e.time),full_playlist.length>0&&s.sendNext({title:full_playlist[0].title,videoId:full_playlist[0].id}),found_array=[],found_array_index=0}},insertAtBeginning:function(e,t){var a=0==f.page?"":"none",i=f.generateSong(e,t,!1,!0,!1,a,!1);$("#wrapper").append(i)},insertAtIndex:function(e,t,a){var i=f.getIndexOfSong(e.id),n="none";if(!e.now_playing){i>=f.page&&i<f.page+f.can_fit&&(n="inline-block");var l=f.generateSong(e,t,!1,!0,!1,n,!1);0===i?$("#wrapper").prepend(l):$("#wrapper > div:nth-child("+i+")").after(l);var s=$("#wrapper").children()[i];$(s).css("display",n),"inline-block"==n&&$("#wrapper").children().length>=f.page+f.can_fit+1?$($("#wrapper").children()[f.page+f.can_fit]).css("display","none"):i<f.page&&$("#wrapper").children().length-(f.page+1)>=0?$($("#wrapper").children()[f.page]).css("display","inline-block"):$("#wrapper").children().length>f.page+f.can_fit&&$($("#wrapper").children()[f.page+f.can_fit-1]).css("display","inline-block"),a&&f.page>0&&$($("#wrapper").children()[f.page-1]).css("display","none"),t&&setTimeout(function(){$(s).css("transform","translateX(0%)"),setTimeout(function(){$(s).removeClass("side_away")},300)},5)}},populate_list:function(e,t){if(o.mobilecheck()||k?k?(f.can_fit=Math.round($("#wrapper").height()/91)+1,f.element_height=$("#wrapper").height()/f.can_fit-4):(f.can_fit=Math.round(($(window).height()-$(".tabs").height()-$("header").height()-64-8)/71)+1,f.element_height=($(window).height()-$(".tabs").height()-$("header").height()-64-8)/f.can_fit-5):(f.can_fit=Math.round($("#wrapper").height()/71)+1,f.element_height=$("#wrapper").height()/f.can_fit-5.3),f.element_height<55.2&&(f.can_fit=f.can_fit-1,f.element_height=55.2,f.can_fit=Math.round(($(window).height()-$(".tabs").height()-$("header").height()-64-8)/71),f.element_height=($(window).height()-$(".tabs").height()-$("header").height()-64-8)/f.can_fit-5),void 0===v&&(v=$("#list-song-html").html()),full_playlist=e,V&&!t)for(var a=0;a<full_playlist.length;a++)full_playlist[a].votes=0;f.sortList(),$("#wrapper").empty(),o.log("---------------------------"),o.log("---------FULL PLAYLIST-----"),o.log(full_playlist),o.log("---------------------------"),full_playlist.length>1?($.each(full_playlist,function(e,t){if(!t.now_playing){var a=f.generateSong(t,!1,x,!0,!1,"",!0);$("#wrapper").append(a)}}),$("#wrapper").children().length>f.can_fit&&!$("#pageButtons").length?($('<div id="pageButtons"><span class="first_page_hide btn-flat"><i class="material-icons">first_page</i></span><a class="first_page waves-effect waves-light btn-flat"><i class="material-icons">first_page</i></a><span class="prev_page_hide btn-flat"><i class="material-icons">navigate_before</i> prev</span><a class="prev_page waves-effect waves-light btn-flat"><i class="material-icons">navigate_before</i> prev</a> <span id="pageNumber">1</span> <a class="next_page waves-effect waves-light btn-flat">next <i class="material-icons">navigate_next</i></a><span class="next_page_hide btn-flat">next <i class="material-icons">navigate_next</i></span><a class="last_page waves-effect waves-light btn-flat"><i class="material-icons">last_page</i></a><span class="last_page_hide btn-flat"><i class="material-icons">last_page</i></span></div>').insertAfter("#wrapper"),$(".prev_page").css("display","none"),$(".first_page").css("display","none"),$(".next_page_hide").css("display","none"),$(".last_page_hide").css("display","none")):$("#pageButtons").length||($('<div id="pageButtons"><span class="first_page_hide btn-flat"><i class="material-icons">first_page</i></span><a class="first_page waves-effect waves-light btn-flat"><i class="material-icons">first_page</i></a><span class="prev_page_hide btn-flat"><i class="material-icons">navigate_before</i> prev</span><a class="prev_page waves-effect waves-light btn-flat"><i class="material-icons">navigate_before</i> prev</a> <span id="pageNumber">1</span> <a class="next_page waves-effect waves-light btn-flat">next <i class="material-icons">navigate_next</i></a><span class="next_page_hide btn-flat">next <i class="material-icons">navigate_next</i></span><a class="last_page waves-effect waves-light btn-flat"><i class="material-icons">last_page</i></a><span class="last_page_hide btn-flat"><i class="material-icons">last_page</i></span></div>').insertAfter("#wrapper"),$(".prev_page").css("display","none"),$(".next_page").css("display","none"),$(".last_page").css("display","none"),$(".first_page").css("display","none"),$(".next_page_hide").css("display","inline-flex"),$(".prev_page_hide").css("display","inline-flex")),f.dynamicContentPage(-10)):(f.empty=!0,$("#wrapper").html("<span id='empty-channel-message'>The playlist is empty.</span>"),$("#pageButtons").length||$('<div id="pageButtons"><span class="first_page_hide btn-flat"><i class="material-icons">first_page</i></span><a class="first_page waves-effect waves-light btn-flat"><i class="material-icons">first_page</i></a><span class="prev_page_hide btn-flat"><i class="material-icons">navigate_before</i> prev</span><a class="prev_page waves-effect waves-light btn-flat"><i class="material-icons">navigate_before</i> prev</a> <span id="pageNumber">1</span> <a class="next_page waves-effect waves-light btn-flat">next <i class="material-icons">navigate_next</i></a><span class="next_page_hide btn-flat">next <i class="material-icons">navigate_next</i></span><a class="last_page waves-effect waves-light btn-flat"><i class="material-icons">last_page</i></a><span class="last_page_hide btn-flat"><i class="material-icons">last_page</i></span></div>').insertAfter("#wrapper"),$(".prev_page").css("display","none"),$(".next_page").css("display","none"),$(".last_page").css("display","none"),$(".last_page_hide").css("display","inline-flex"),$(".first_page").css("display","none"),$(".next_page_hide").css("display","inline-flex"),$(".prev_page_hide").css("display","inline-flex")),$("#settings").css("visibility","visible"),$("#settings").css("opacity","1"),$("#wrapper").css("opacity","1")},dynamicContentPageJumpTo:function(e){((e*=f.can_fit)>f.page||e<f.page)&&($("#wrapper").children().slice(f.page,f.page+f.can_fit).hide(),f.page=e,$("#wrapper").children().slice(f.page,f.page+f.can_fit).css("display","inline-block"),f.page>0&&"none"==$(".prev_page").css("display")&&($(".prev_page").css("display","inline-flex"),$(".prev_page_hide").css("display","none"),$(".first_page").css("display","inline-flex"),$(".first_page_hide").css("display","none")),f.page+f.can_fit>=$("#wrapper").children().length&&($(".next_page_hide").css("display","inline-flex"),$(".next_page").css("display","none"),$(".last_page_hide").css("display","inline-flex"),$(".last_page").css("display","none")),$("#pageNumber").html(f.page/f.can_fit+1))},dynamicContentPage:function(e){1==e?($("#wrapper").children().slice(f.page,f.page+f.can_fit).hide(),f.page=f.page+f.can_fit,$("#wrapper").children().slice(f.page,f.page+f.can_fit).css("display","inline-block"),f.page>0&&"none"==$(".prev_page").css("display")&&($(".prev_page").css("display","inline-flex"),$(".prev_page_hide").css("display","none"),$(".first_page").css("display","inline-flex"),$(".first_page_hide").css("display","none")),f.page+f.can_fit>=$("#wrapper").children().length&&($(".next_page_hide").css("display","inline-flex"),$(".next_page").css("display","none"),$(".last_page_hide").css("display","inline-flex"),$(".last_page").css("display","none"))):10==e?($("#wrapper").children().slice(f.page,f.page+f.can_fit).hide(),f.page=Math.floor(($("#wrapper").children().length-1)/f.can_fit)*f.can_fit,$("#wrapper").children().slice(f.page,f.page+f.can_fit).css("display","inline-block"),f.page>0&&"none"==$(".prev_page").css("display")&&($(".prev_page").css("display","inline-flex"),$(".prev_page_hide").css("display","none"),$(".first_page").css("display","inline-flex"),$(".first_page_hide").css("display","none")),f.page+f.can_fit>=$("#wrapper").children().length&&($(".next_page_hide").css("display","inline-flex"),$(".next_page").css("display","none"),$(".last_page_hide").css("display","inline-flex"),$(".last_page").css("display","none"))):-10==e?($("#wrapper").children().slice(f.page,f.page+f.can_fit).hide(),f.page=0,$("#wrapper").children().slice(f.page,f.page+f.can_fit).css("display","inline-block"),0==f.page&&"none"!=$(".prev_page").css("display")?($(".prev_page").css("display","none"),$(".prev_page_hide").css("display","inline-flex"),$(".first_page").css("display","none"),$(".first_page_hide").css("display","inline-flex")):"none"==$(".prev_page").css("display")?($(".prev_page_hide").css("display","inline-flex"),$(".first_page_hide").css("display","inline-flex")):($(".prev_page_hide").css("display","none"),$(".first_page_hide").css("display","none")),f.page+f.can_fit<$("#wrapper").children().length&&($(".next_page_hide").css("display","none"),$(".next_page").css("display","inline-flex"),$(".last_page_hide").css("display","none"),$(".last_page").css("display","inline-flex"))):($("#wrapper").children().slice(f.page-f.can_fit,f.page).css("display","inline-block"),$("#wrapper").children().slice(f.page,f.page+f.can_fit).hide(),f.page=f.page-f.can_fit<0?0:f.page-f.can_fit,0==f.page&&"none"!=$(".prev_page").css("display")?($(".prev_page").css("display","none"),$(".prev_page_hide").css("display","inline-flex"),$(".first_page").css("display","none"),$(".first_page_hide").css("display","inline-flex")):"none"==$(".prev_page").css("display")?($(".prev_page_hide").css("display","inline-flex"),$(".first_page_hide").css("display","inline-flex")):($(".prev_page_hide").css("display","none"),$(".first_page_hide").css("display","none")),f.page+f.can_fit<$("#wrapper").children().length&&($(".next_page_hide").css("display","none"),$(".next_page").css("display","inline-flex"),$(".last_page_hide").css("display","none"),$(".last_page").css("display","inline-flex"))),$("#pageNumber").html(f.page/f.can_fit+1)},added_song:function(e){var t;if(void 0!=e){if(0!==full_playlist.length&&(t=full_playlist.pop()),full_playlist.push(e),f.sortList(),t&&full_playlist.push(t),$("#suggested-"+e.id).length>0){number_suggested-=1,number_suggested<0&&(number_suggested=0);var a=number_suggested>9?"9+":number_suggested;$(".suggested-link span.badge.new.white").hasClass("hide")||0!=a||$(".suggested-link span.badge.new.white").addClass("hide"),$(".suggested-link span.badge.new.white").text(a)}$("#suggested-"+e.id).remove(),f.empty&&(f.empty=!1),$("#empty-channel-message").remove(),f.insertAtIndex(e,!0),$($("#wrapper").children()[f.page+f.can_fit]).css("display","none"),$("#wrapper").children().length>f.page+f.can_fit?($(".next_page_hide").css("display","none"),$(".next_page").removeClass("hide"),$(".last_page_hide").css("display","none"),$(".next_page").css("display","inline-flex"),$(".last_page").css("display","inline-flex")):($(".next_page_hide").css("display","inline-flex"),$(".next_page").css("display","none"))}},deleted_song:function(e,t){try{var a=f.getIndexOfSong(e);a<f.page&&$("#wrapper").children().length-(f.page+2)>=0?($($("#wrapper").children()[f.page]).css("height",0),$($("#wrapper").children()[f.page]).css("display","inline-block"),$($("#wrapper").children()[f.page]).css("height",f.element_height)):$("#wrapper").children().length>f.page+f.can_fit&&($($("#wrapper").children()[f.page+f.can_fit]).css("height",0),$($("#wrapper").children()[f.page+f.can_fit]).css("display","inline-block"),$($("#wrapper").children()[f.page+f.can_fit]).css("height",f.element_height)),f.page>=$("#wrapper").children().length-1?(f.dynamicContentPage(-1),$(".next_page_hide").css("display","inline-flex"),$(".next_page").css("display","none"),$(".last_page_hide").css("display","inline-flex"),$(".last_page").css("display","none")):f.page+f.can_fit+1>=$("#wrapper").children().length-1&&($(".next_page_hide").css("display","inline-flex"),$(".next_page").css("display","none"),$(".last_page_hide").css("display","inline-flex"),$(".last_page").css("display","none")),f.page<=a&&f.page-f.can_fit<=a?($("#"+e).addClass("side_away"),$("#"+e).find(".mobile-delete").remove(),$("#"+e).css("transform","translateX(-100%)"),setTimeout(function(){$("#"+e).remove()},300)):$("#"+e).remove(),full_playlist.splice(f.getIndexOfSong(e),1),s.sendNext({title:full_playlist[0].title,videoId:full_playlist[0].id})}catch(t){full_playlist.splice(f.getIndexOfSong(e),1),f.empty||($("#"+e).remove(),a<f.page&&$("#wrapper").children().length-(f.page+1)>=0?$($("#wrapper").children()[f.page-1]).css("display","inline-block"):$("#wrapper").children().length>f.page+f.can_fit&&$($("#wrapper").children()[f.page+(f.can_fit-1)]).css("display","inline-block"),s.sendNext({title:full_playlist[0].title,videoId:full_playlist[0].id}))}full_playlist.length<=2&&(f.empty=!0,$("#wrapper").html("<span id='empty-channel-message'>The playlist is empty.</span>")),$("#suggested-"+e).remove(),f.page,f.can_fit,$("#wrapper").children().length,f.page>=$("#wrapper").children().length&&f.dynamicContentPage(-1),Suggestions.checkUserEmpty()},voted_song:function(e,t){var a=f.getIndexOfSong(e),i=full_playlist[a];full_playlist[a].votes+=1,full_playlist[a].added=t,f.sortList(),$("#"+e).remove(),f.insertAtIndex(i,!1)},song_change_prev:function(e){full_playlist[full_playlist.length-1].now_playing=!1,full_playlist[full_playlist.length-1].votes=full_playlist[0].votes,full_playlist[full_playlist.length-1].guids=[],full_playlist[full_playlist.length-1].added=full_playlist[0].added-1,full_playlist.unshift(full_playlist.pop()),full_playlist[full_playlist.length-1].now_playing=!0,$("#wrapper").children()[$("#wrapper").children().length-1].remove();var t=full_playlist.length-2;t<0&&(t=0),f.insertAtIndex(full_playlist[0],!1,!0)},song_change:function(e,t){try{var a=full_playlist.length-1;$("#wrapper").children()[0].remove(),full_playlist.length<=1&&(f.empty=!0,$("#wrapper").html("<span id='empty-channel-message'>The playlist is empty.</span>")),full_playlist[0].now_playing=!0,full_playlist[0].votes=0,full_playlist[0].guids=[],full_playlist[0].added=e,t?delete full_playlist[a]:full_playlist[a].now_playing=!1,o.log("---------------------------"),o.log("---SONG ON FIRST INDEX-----"),o.log(full_playlist[0]),o.log("---------------------------"),full_playlist.push(full_playlist.shift()),t||f.insertAtIndex(full_playlist[$("#wrapper").children().length],!1,!0)}catch(e){}},vote:function(e,t){return!V||"del"==t&&hasadmin&&!w&&""!=S?c.emit("vote",{channel:z,id:e,type:t,adminpass:""==S?"":q.crypt_pass(S),pass:k?"":q.crypt_pass(q.get_userpass(z.toLowerCase()))}):"pos"==t?f.voted_song(e,(new Date).getTime()/1e3):f.deleted_song(e),!0},skip:function(e){return V?e?s.playNext():s.playPrev():c.emit("skip",{pass:""==S?"":q.crypt_pass(S),id:d,channel:z.toLowerCase(),userpass:k?"":q.crypt_pass(q.get_userpass(z.toLowerCase()))}),!0},exportToSpotify:function(){$.ajax({type:"GET",url:"https://api.spotify.com/v1/me",headers:{Authorization:"Bearer "+access_token_data.access_token},success:function(e){var t=e.id;$("#playlist_loader_export").removeClass("hide"),$(".exported-list-container").removeClass("hide"),$.ajax({type:"POST",url:"https://api.spotify.com/v1/users/"+t+"/playlists",headers:{Authorization:"Bearer "+access_token_data.access_token,"Content-Type":"application/json"},data:JSON.stringify({name:z.toLowerCase()+" - Zoff",public:!0}),success:function(e){var a=e.id;$.each(full_playlist,function(e,i){f.searchSpotify(i,a,t)})}})}})},searchSpotify:function(e,t,a){var i=e.title,n=e.title.toLowerCase().replace("-"," ");n.startsWith("the")&&(n=n.replace("the","")),n=n.replace(" hd",""),n=n.replace("official hd video",""),n=n.replace("unofficial video",""),n=n.replace("studio footage",""),n=n.replace("great song",""),n=n.replace("-"," "),n=n.replace("-"," "),n=n.replace(" hq"," "),n=n.replace("lyric video",""),n=n.replace("lyrics video",""),n=n.replace("album version",""),n=n.replace("drive original movie soundtrack",""),n=n.replace("original movie soundtrack",""),n=n.replace("live sessions",""),n=n.replace("audio only",""),n=n.replace("audio",""),n=n.replace("(new)",""),n=n.replace(" by "," "),n=n.replace(" vs "," "),n=n.replace("(full)"," "),n=n.replace("(video)"," "),n=n.replace("&"," "),n=n.replace("with lyrics",""),n=n.replace("lyrics",""),n=n.replace("w/",""),n=n.replace("w/",""),n=n.replace("official video",""),n=n.replace("studio version",""),n=n.replace("official music video",""),n=n.replace("music video",""),n=n.replace("musicvideo",""),n=n.replace("original video",""),n=n.replace("full version",""),n=n.replace("full song",""),n=n.replace("(official)",""),n=n.replace("official",""),n=n.replace("(original)",""),n=n.replace("("," "),n=n.replace(")"," "),n=n.replace("|",""),n=n.replace("feat."," "),n=n.replace("feat"," "),n=n.replace("ft."," "),n=n.replace("["," "),n=n.replace("]"," "),n=n.replace(" free ",""),n=n.replace(" hd",""),n=n.replace("original mix"," "),n=n.replace("radio edit"," "),n=n.replace("pop version"," "),n=n.replace("  "," ").replace("  "," ").replace("  "," ").replace("  "," ").replace("  "," ").replace("  "," "),n=encodeURIComponent(n),$.ajax({type:"GET",url:"https://api.spotify.com/v1/search?q="+n+"&type=track",headers:{Authorization:"Bearer "+access_token_data.access_token},async:!0,statusCode:{429:function(i){o.log(i.getAllResponseHeaders());var n=i.getResponseHeader("Retry-After");o.log(n),n||(n=5),n=parseInt(n,10),o.log("Retry-After",n),setTimeout(function(){f.searchSpotify(e,t,a)},1e3*n)}},error:function(i){if(429==i.status){o.log(i.getAllResponseHeaders());var n=i.getResponseHeader("Retry-After");o.log(n),n||(n=5),n=parseInt(n,10),o.log("Retry-After",n),setTimeout(function(){f.searchSpotify(e,t,a)},1e3*n)}},success:function(e){var l=!1;if($.each(e.tracks.items,function(e,t){if(t.name=t.name.toLowerCase(),t.name=t.name.replace("("," "),t.name=t.name.replace(")"," "),t.name=t.name.replace("["," "),t.name=t.name.replace("]"," "),t.name=t.name.replace("-"," "),t.name=t.name.replace("-"," "),t.name=t.name.replace("-"," "),t.name=t.name.replace("original mix"," "),t.name=t.name.replace("album version"," "),t.name=t.name.replace("abum version"," "),t.name=t.name.replace("feat."," "),t.artists[0].name=t.artists[0].name.replace("feat."," "),t.artists[0].name=t.artists[0].name.replace("feat"," "),t.name=t.name.replace("feat"," "),t.name=t.name.replace("ft."," "),t.name=t.name.replace("radio edit"," "),t.name=t.name.replace("pop version"," "),t.name=t.name.replace("  "," ").replace("  "," ").replace("  "," ").replace("  "," ").replace("  "," ").replace("  "," ").replace("  "," ").replace("  "," "),t.artists[0].name=t.artists[0].name.replace("  "," ").replace("  "," ").replace("  "," ").replace("  "," ").replace("  "," ").replace("  "," ").replace("  "," ").replace("  "," ")," "==t.name.substring(t.name.length-1)&&(t.name=t.name.substring(0,t.name.length-1)),"."==t.name.substring(t.name.length-1)&&"."!=n.substring(n.length-1)&&(t.name=t.name.substring(0,t.name.length-1)),decodeURIComponent(n).indexOf(t.artists[0].name.toLowerCase())>=0&&decodeURIComponent(n).indexOf(t.name.toLowerCase())>=0)return l=!0,f.uris.push(t.uri),o.log("Found",n),!1;for(var a=t.name.split(" "),e=0;e<a.length;e++)if(!("and"==a[e]&&n.indexOf("&")>=0||"&"==a[e]&&n.indexOf("and")>=0)&&n.indexOf(a[e])<0)return!0;return l=!0,f.uris.push(t.uri),o.log("Found",n),!1}),l||(f.not_found.push(i),f.num_songs=f.num_songs+1,o.log("Didn't find",i)),f.num_songs+f.uris.length==full_playlist.length){if(f.uris.length>100){for(;f.uris.length>100;)f.addToSpotifyPlaylist(f.uris.slice(0,100),t,a),f.uris=f.uris.slice(100,f.uris.length);f.addToSpotifyPlaylist(f.uris,t,a),$("#playlist_loader_export").addClass("hide")}else f.addToSpotifyPlaylist(f.uris,t,a),$("#playlist_loader_export").addClass("hide");0==$(".exported-spotify-list").length&&$(".exported-list").append("<a target='_blank' class='btn light exported-playlist exported-spotify-list' href='https://open.spotify.com/user/"+a+"/playlist/"+t+"'>"+z+"</a>"),$.each(f.not_found,function(e,t){var a=$("<div>"+not_export_html+"</div>");a.find(".extra-add-text").attr("value",t),a.find(".extra-add-text").attr("title",t),$(".not-exported-container").append(a.html())}),$(".not-exported").removeClass("hide"),$(".spotify_export_button").css("display","block")}}})},addToSpotifyPlaylist:function(e,t,a){$.ajax({type:"POST",url:"https://api.spotify.com/v1/users/"+a+"/playlists/"+t+"/tracks",headers:{Authorization:"Bearer "+access_token_data.access_token,"Content-Type":"application/json"},data:JSON.stringify({uris:e}),error:function(i){var n=t,l=e,s=a;setTimeout(function(){f.addToSpotifyPlaylist(l,n,s)},3e3)},success:function(e){o.log("Added songs")}})},exportToYoutube:function(){$(".exported-list-container").removeClass("hide"),$("#playlist_loader_export").removeClass("hide"),$.ajax({type:"POST",url:"https://www.googleapis.com/youtube/v3/playlists?part=snippet",headers:{Authorization:"Bearer "+access_token_data_youtube.access_token,"Content-Type":"application/json"},data:JSON.stringify({snippet:{title:o.upperFirst(z.toLowerCase()),description:"Playlist exported from zoff"}}),success:function(e){var t=e.id;f.addToYoutubePlaylist(t,full_playlist,0,"https://www.googleapis.com/youtube/v3/playlistItems?part=snippet")},error:function(e){o.log(e)}})},addToYoutubePlaylist:function(e,t,a,i){var n=JSON.stringify({snippet:{playlistId:e,resourceId:{kind:"youtube#video",videoId:t[a].id}}});$.ajax({type:"POST",url:i,headers:{Authorization:"Bearer "+access_token_data_youtube.access_token,"Content-Type":"application/json"},data:n,success:function(n){o.log("Added video: "+t[a].id+" to playlist id "+e),a==t.length-1?(o.log("All videoes added!"),o.log("url: https://www.youtube.com/playlist?list="+e),$(".exported-list").append("<a target='_blank' class='btn light exported-playlist' href='https://www.youtube.com/playlist?list="+e+"'>"+z+"</a>"),$("#playlist_loader_export").addClass("hide"),$(".current_number").addClass("hide")):($(".current_number").removeClass("hide"),$(".current_number").text(a+1+" of "+t.length),f.addToYoutubePlaylist(e,t,a+1,i))}})},sortList:function(){full_playlist.sort(o.predicate({name:"votes",reverse:!0},{name:"added",reverse:!1},{name:"title",reverse:!1}))},show:function(){o.mobilecheck()||(showToggle?(showToggle=!1,$("#toptitle").empty(),$("#chan").addClass("bigChan"),$("#chan").html("zoff.me/"+z.toLowerCase())):(showToggle=!0,$("#toptitle").html("Zoff"),$("#chan").removeClass("bigChan"),$("#chan").html(z)))},generateSong:function(e,t,a,i,n,l,s){void 0===v&&(v=$("#list-song-html").html());var r,p,c=e.id,d=e.title,g=e.votes,u="background-image:url('//img.youtube.com/vi/"+c+"/mqdefault.jpg');",h=$("<div>"+v+"</div>"),m="style";if(t&&(h.find(".list-song").css("transform","translateX(100%)"),h.find(".list-song").addClass("side_away")),h.find(".list-song").css("height",f.element_height),w||h.find(".card-action").removeClass("hide"),1==g&&h.find(".vote-text").text("vote"),a&&(u="//img.youtube.com/vi/"+c+"/mqdefault.jpg",m="data-original"),i){h.find(".list-votes").text(g),h.find("#list-song").attr("data-video-id",c),h.find("#list-song").attr("data-video-type","song"),h.find("#list-song").attr("id",c),h.find(".vote-container").attr("title",d),($("#wrapper").children().length>=f.can_fit&&s||"none"==l)&&h.find(".card").css("display","none"),r=".vote-container",p="delete_button";var y=o.secondsToOther(e.duration);h.find(".card-duration").text(o.pad(y[0])+":"+o.pad(y[1]))}else if(!i){h.find(".suggested_remove").removeClass("hide"),h.find(".vote-text").text(""),h.find(".card-duration").text(o.pad(e.duration[0])+":"+o.pad(e.duration[1]));var _="user";r=".add-suggested",n?p="del_user_suggested":(p="del_suggested",_="system"),h.find(".vote-container").attr("class","clickable add-suggested"),h.find(".add-suggested").attr("title",d),h.find(".delete_button").addClass(p),h.find(r).attr("data-video-title",d),h.find(r).attr("data-video-length",e.length),h.find(r).attr("data-added-by",_),h.find("#list-song").attr("data-video-type","suggested"),h.find("#list-song").attr("data-video-id",c),h.find("#list-song").attr("id","suggested-"+c),h.find(".list-image").attr("class",h.find(".list-image").attr("class").replace("list-image","list-suggested-image"))}return h.find(".mobile-delete").remove(),h.find(".list-title").text(d),h.find(".list-title").attr("title",d),h.find(r).attr("data-video-id",c),h.find(".list-image").attr(m,u),h.find(".list-suggested-image").attr(m,u),h.find("."+p).attr("data-video-id",c),h.html()},getIndexOfSong:function(e){try{return indexes=$.map(full_playlist,function(t,a){if(t.id==e)return a}),indexes[0]}catch(e){}},scrollTop:function(){$("#wrapper").scrollTop(0)},scrollBottom:function(){$("#wrapper").scrollTop($("#wrapper")[0].scrollHeight)}},m="",y=!1,_=!1,v=$("#list-song-html").html(),w=!0,x=!1,k=!0,C=100,S="",T=!1,I=!1,M=!1,P=!1,V=!1,A=!1,L=!1,E=window.location.hash.substring(1).split("&"),z=E[0],Y=!1,N="#808080",B=!1,j=!1,O=!1,R={"sync disconnect on unload":!0,secure:!0,"force new connection":!0},q={crypt_pass:function(e){return e}};window.addEventListener("message",e,!1),$(document).ready(function(){E.length>=3&&"autoplay"==E[2]?Y=!0:y=!0,E.indexOf("videoonly")>-1&&($("#playlist").addClass("hide"),$("#controls").addClass("hide"),$("#player").addClass("video_only")),$("#locked_channel").modal({dismissible:!1}),N="#"+E[1],add="https://zoff.me",c=io.connect(add+":8080",R),c.on("auth_required",function(){$("#locked_channel").modal("open")}),c.on("get_list",function(){setTimeout(function(){c.emit("list",{channel:z.toLowerCase(),pass:""})},1e3)}),c.on("self_ping",function(){void 0!=z&&""!=z.toLowerCase()&&c.emit("self_ping",{channel:z.toLowerCase()})}),c.on("viewers",function(e){viewers=e,void 0!==m&&s.getTitle(m,viewers)}),a(),i(),n(),window.onYouTubeIframeAPIReady=s.onYouTubeIframeAPIReady,s.loadPlayer(),h.initSlider(),window.setVolume=l,$("#controls").css("background-color",N),$("#playlist").css("background-color",N),E.indexOf("controll")>-1?D.change_enabled(!0):D.change_enabled(!1)}),$(document).on("click","#zoffbutton",function(e){window.open("https://zoff.me/"+z.toLowerCase()+"/","_blank")}),$(document).on("click",".vote-container",function(e){var t=$(this).attr("data-video-id");f.vote(t,"pos")}),$(document).on("click",".prev_page",function(e){e.preventDefault(),f.dynamicContentPage(-1)}),$(document).on("click",".next_page",function(e){e.preventDefault(),f.dynamicContentPage(1)});var D={enabled:!0,old_id:null,host_listener:function(e){null===D.old_id?D.old_id=e:(c.removeAllListeners(e),A=!1,D.old_id=e),k&&window.parentWindow&&window.parentOrigin&&window.parentWindow.postMessage({type:"controller",id:e},window.parentOrigin);var a="https://remote."+window.location.hostname+"/"+e;$("#code-text").text(e),$("#code-qr").attr("src","https://chart.googleapis.com/chart?chs=221x221&cht=qr&choe=UTF-8&chld=L|1&chl="+a),$("#code-link").attr("href",a),A||(A=!0,t(e))},host_on_action:function(e){if(enabled)if("volume"==e.type)$("#volume").slider("value",e.value),s.player.setVolume(e.value),localStorage.setItem("volume",e.value),h.choose_button(e.value,!1);else if("channel"==e.type){c.emit("change_channel"),Admin.beginning=!0,z=e.value.toLowerCase(),$("#chan").html(o.upperFirst(z)),w=!0;var t="";P&&(t=q.getCookie("_uI")+"_"),c.emit("list",{channel:t+z.toLowerCase(),pass:k?"":q.crypt_pass(q.get_userpass(z.toLowerCase()))}),window.history.pushState("object or string","Title","/"+z.toLowerCase())}else"pause"==e.type?s.pauseVideo():"play"==e.type?s.playVideo():"skip"==e.type&&f.skip()},change_enabled:function(e){enabled=e,$(".remote_switch_class").prop("checked",enabled)}}}();